{"ast":null,"code":"import _objectSpread from\"D:/Collabryta/collabryta-frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{createContext,useContext,useState,useEffect,useCallback,useRef}from'react';import{notificationService}from'../services/notificationService';import{authService}from'../services/authService';import{Bell,AlertCircle,X,Shield,Zap}from'lucide-react';import{motion,AnimatePresence}from'framer-motion';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const NotificationContext=/*#__PURE__*/createContext(undefined);export const NotificationProvider=_ref=>{let{children}=_ref;const[notifications,setNotifications]=useState([]);const[unreadCount,setUnreadCount]=useState(0);const[isConnected,setIsConnected]=useState(false);const[toast,setToast]=useState(null);const[user,setUser]=useState(null);const ws=useRef(null);const reconnectTimer=useRef(null);const showToast=useCallback(function(title,message){let type=arguments.length>2&&arguments[2]!==undefined?arguments[2]:'info';setToast({title,message,type});setTimeout(()=>setToast(null),6000);},[]);const fetchNotifications=useCallback(async function(){let showToastIfNew=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(!authService.isAuthenticated())return;try{const data=await notificationService.getNotifications(0,50);if(showToastIfNew){setNotifications(prev=>{if(data.length>0&&prev.length>0){const latestNew=data[0];const alreadyKnown=prev.some(n=>n.id===latestNew.id);if(!alreadyKnown&&!latestNew.is_read){const content=latestNew.description||latestNew.content||latestNew.message||'';showToast(latestNew.title,content,latestNew.type||'info');}}return data;});}else{setNotifications(data);}const unread=data.filter(n=>!n.is_read).length;setUnreadCount(unread);}catch(err){console.error('[Notifications] Fetch Error:',err);}},[showToast]);const addNotification=useCallback(payload=>{const id=payload.id||Date.now();const content=payload.description||payload.content||payload.message||'';const newNotif={id,title:payload.title||'Notification',description:content,type:payload.type||'info',created_at:payload.created_at||new Date().toISOString(),is_read:false,user_id:(user===null||user===void 0?void 0:user.id)||0};setNotifications(prev=>{if(prev.some(n=>n.id===id))return prev;showToast(newNotif.title,content,newNotif.type);return[newNotif,...prev];});setUnreadCount(prev=>prev+1);},[showToast,user===null||user===void 0?void 0:user.id]);const connectWebSocket=useCallback(userId=>{var _ws$current;if(((_ws$current=ws.current)===null||_ws$current===void 0?void 0:_ws$current.readyState)===WebSocket.OPEN)return;const protocol=window.location.protocol==='https:'?'wss:':'ws:';const hostname=window.location.hostname;const port='8000';// Target port for backend\nconst url=\"\".concat(protocol,\"//\").concat(hostname,\":\").concat(port,\"/ws/\").concat(userId);console.log(\"[WebSocket] Connecting to \".concat(url,\"...\"));try{const socket=new WebSocket(url);socket.onopen=()=>{console.log('%c[WebSocket] Connected ✓','color: #10b981; font-weight: bold');setIsConnected(true);if(reconnectTimer.current)clearInterval(reconnectTimer.current);};socket.onmessage=event=>{try{const data=JSON.parse(event.data);console.log('[WebSocket] Message received:',data);addNotification(data);// Dispatch global event for data refresh\nwindow.dispatchEvent(new Event('app-data-refresh'));}catch(e){console.error('[WebSocket] Parse Error:',e);}};socket.onclose=e=>{console.warn('[WebSocket] Closed:',e.reason||'No reason');setIsConnected(false);// Auto-reconnect every 10 seconds if still logged in\nif(!reconnectTimer.current&&authService.isAuthenticated()){reconnectTimer.current=setInterval(()=>{console.log('[WebSocket] Attempting reconnect...');connectWebSocket(userId);},10000);}};socket.onerror=err=>{console.error('[WebSocket] Error:',err);};ws.current=socket;}catch(err){console.error('[WebSocket] Setup Error:',err);}},[addNotification]);useEffect(()=>{const init=async()=>{if(authService.isAuthenticated()){try{const currentUser=await authService.getCurrentUser();setUser(currentUser);fetchNotifications();if(currentUser!==null&&currentUser!==void 0&&currentUser.id){connectWebSocket(currentUser.id);}}catch(err){console.error('[Notifications] Init Error:',err);}}};if(authService.isAuthenticated()&&!user){init();}return()=>{if(ws.current)ws.current.close();if(reconnectTimer.current)clearInterval(reconnectTimer.current);};},[connectWebSocket,fetchNotifications,user]);// Fallback polling (every 2 minutes)\nuseEffect(()=>{const poll=setInterval(()=>{if(authService.isAuthenticated())fetchNotifications(true);},120000);return()=>clearInterval(poll);},[fetchNotifications]);const markAsRead=async id=>{try{await notificationService.markAsRead(id);setNotifications(prev=>prev.map(n=>n.id===id?_objectSpread(_objectSpread({},n),{},{is_read:true}):n));setUnreadCount(prev=>Math.max(0,prev-1));}catch(err){console.error('[Notifications] Mark Read Error:',err);}};const markAllAsRead=async()=>{try{await notificationService.markAllAsRead();setNotifications(prev=>prev.map(n=>_objectSpread(_objectSpread({},n),{},{is_read:true})));setUnreadCount(0);}catch(err){console.error('[Notifications] Mark All Read Error:',err);}};const getIconForToastType=type=>{switch(type){case'success':return/*#__PURE__*/_jsx(Shield,{size:20});case'error':return/*#__PURE__*/_jsx(AlertCircle,{size:20});case'warning':return/*#__PURE__*/_jsx(Zap,{size:20});default:return/*#__PURE__*/_jsx(Bell,{size:20});}};return/*#__PURE__*/_jsxs(NotificationContext.Provider,{value:{notifications,unreadCount,addNotification,markAsRead,markAllAsRead,refresh:fetchNotifications,showToast,isConnected},children:[children,/*#__PURE__*/_jsx(AnimatePresence,{children:toast&&/*#__PURE__*/_jsx(motion.div,{initial:{opacity:0,x:100,y:20},animate:{opacity:1,x:0,y:0},exit:{opacity:0,x:100,scale:0.9},transition:{type:\"spring\",stiffness:400,damping:30},className:\"fixed top-24 right-6 z-[9999] w-full max-w-[380px]\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"relative group overflow-hidden rounded-2xl border border-white/20 bg-white/80 backdrop-blur-xl shadow-[0_20px_50px_rgba(0,0,0,0.1)] p-5 flex items-start gap-4 transition-all hover:shadow-[0_25px_60px_rgba(0,0,0,0.15)]\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-0 left-0 w-1.5 h-full \".concat(toast.type==='success'?'bg-gradient-to-b from-emerald-400 to-teal-500':toast.type==='error'?'bg-gradient-to-b from-rose-400 to-red-600':toast.type==='warning'?'bg-gradient-to-b from-amber-400 to-orange-500':'bg-gradient-to-b from-indigo-500 to-blue-600')}),/*#__PURE__*/_jsx(\"div\",{className:\"shrink-0 p-3 rounded-xl \".concat(toast.type==='success'?'bg-emerald-50 text-emerald-600':toast.type==='error'?'bg-rose-50 text-rose-600':toast.type==='warning'?'bg-amber-50 text-amber-600':'bg-indigo-50 text-indigo-600'),children:getIconForToastType(toast.type)}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 min-w-0\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-1\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-[10px] font-bold uppercase tracking-wider \".concat(toast.type==='success'?'text-emerald-600':toast.type==='error'?'text-rose-600':toast.type==='warning'?'text-amber-600':'text-indigo-600'),children:[toast.type||'info',\" alert\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setToast(null),className:\"text-slate-400 hover:text-slate-600 transition-colors\",children:/*#__PURE__*/_jsx(X,{size:16})})]}),/*#__PURE__*/_jsx(\"h4\",{className:\"text-sm font-bold text-slate-900 leading-tight mb-1\",children:toast.title}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs font-medium text-slate-600 leading-relaxed line-clamp-3\",children:toast.message})]})]})})})]});};export const useNotifications=()=>{const context=useContext(NotificationContext);if(context===undefined){throw new Error('useNotifications must be used within a NotificationProvider');}return context;};","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","useCallback","useRef","notificationService","authService","Bell","AlertCircle","X","Shield","Zap","motion","AnimatePresence","jsx","_jsx","jsxs","_jsxs","NotificationContext","undefined","NotificationProvider","_ref","children","notifications","setNotifications","unreadCount","setUnreadCount","isConnected","setIsConnected","toast","setToast","user","setUser","ws","reconnectTimer","showToast","title","message","type","arguments","length","setTimeout","fetchNotifications","showToastIfNew","isAuthenticated","data","getNotifications","prev","latestNew","alreadyKnown","some","n","id","is_read","content","description","unread","filter","err","console","error","addNotification","payload","Date","now","newNotif","created_at","toISOString","user_id","connectWebSocket","userId","_ws$current","current","readyState","WebSocket","OPEN","protocol","window","location","hostname","port","url","concat","log","socket","onopen","clearInterval","onmessage","event","JSON","parse","dispatchEvent","Event","e","onclose","warn","reason","setInterval","onerror","init","currentUser","getCurrentUser","close","poll","markAsRead","map","_objectSpread","Math","max","markAllAsRead","getIconForToastType","size","Provider","value","refresh","div","initial","opacity","x","y","animate","exit","scale","transition","stiffness","damping","className","onClick","useNotifications","context","Error"],"sources":["D:/Collabryta/collabryta-frontend/src/context/NotificationContext.tsx"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect, useCallback, useRef } from 'react';\r\nimport { notificationService, Notification } from '../services/notificationService';\r\nimport { authService } from '../services/authService';\r\nimport { Bell, AlertCircle, X, Shield, Zap } from 'lucide-react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\n\r\ninterface NotificationContextType {\r\n    notifications: Notification[];\r\n    unreadCount: number;\r\n    addNotification: (notification: any) => void;\r\n    markAsRead: (id: number) => Promise<void>;\r\n    markAllAsRead: () => Promise<void>;\r\n    refresh: () => Promise<void>;\r\n    showToast: (title: string, message: string, type?: 'info' | 'success' | 'warning' | 'error') => void;\r\n    isConnected: boolean;\r\n}\r\n\r\nconst NotificationContext = createContext<NotificationContextType | undefined>(undefined);\r\n\r\nexport const NotificationProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {\r\n    const [notifications, setNotifications] = useState<Notification[]>([]);\r\n    const [unreadCount, setUnreadCount] = useState(0);\r\n    const [isConnected, setIsConnected] = useState(false);\r\n    const [toast, setToast] = useState<{ title: string; message: string; type: string } | null>(null);\r\n    const [user, setUser] = useState<any>(null);\r\n    const ws = useRef<WebSocket | null>(null);\r\n    const reconnectTimer = useRef<NodeJS.Timeout | null>(null);\r\n\r\n    const showToast = useCallback((title: string, message: string, type: string = 'info') => {\r\n        setToast({ title, message, type });\r\n        setTimeout(() => setToast(null), 6000);\r\n    }, []);\r\n\r\n    const fetchNotifications = useCallback(async (showToastIfNew = false) => {\r\n        if (!authService.isAuthenticated()) return;\r\n\r\n        try {\r\n            const data = await notificationService.getNotifications(0, 50);\r\n\r\n            if (showToastIfNew) {\r\n                setNotifications(prev => {\r\n                    if (data.length > 0 && prev.length > 0) {\r\n                        const latestNew = data[0];\r\n                        const alreadyKnown = prev.some(n => n.id === latestNew.id);\r\n                        if (!alreadyKnown && !latestNew.is_read) {\r\n                            const content = latestNew.description || (latestNew as any).content || (latestNew as any).message || '';\r\n                            showToast(latestNew.title, content, latestNew.type || 'info');\r\n                        }\r\n                    }\r\n                    return data;\r\n                });\r\n            } else {\r\n                setNotifications(data);\r\n            }\r\n\r\n            const unread = data.filter(n => !n.is_read).length;\r\n            setUnreadCount(unread);\r\n        } catch (err) {\r\n            console.error('[Notifications] Fetch Error:', err);\r\n        }\r\n    }, [showToast]);\r\n\r\n    const addNotification = useCallback((payload: any) => {\r\n        const id = payload.id || Date.now();\r\n        const content = payload.description || payload.content || payload.message || '';\r\n\r\n        const newNotif: Notification = {\r\n            id,\r\n            title: payload.title || 'Notification',\r\n            description: content,\r\n            type: payload.type || 'info',\r\n            created_at: payload.created_at || new Date().toISOString(),\r\n            is_read: false,\r\n            user_id: user?.id || 0\r\n        };\r\n\r\n        setNotifications(prev => {\r\n            if (prev.some(n => n.id === id)) return prev;\r\n            showToast(newNotif.title, content, newNotif.type);\r\n            return [newNotif, ...prev];\r\n        });\r\n        setUnreadCount(prev => prev + 1);\r\n    }, [showToast, user?.id]);\r\n\r\n    const connectWebSocket = useCallback((userId: number) => {\r\n        if (ws.current?.readyState === WebSocket.OPEN) return;\r\n\r\n        const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';\r\n        const hostname = window.location.hostname;\r\n        const port = '8000'; // Target port for backend\r\n        const url = `${protocol}//${hostname}:${port}/ws/${userId}`;\r\n\r\n        console.log(`[WebSocket] Connecting to ${url}...`);\r\n\r\n        try {\r\n            const socket = new WebSocket(url);\r\n\r\n            socket.onopen = () => {\r\n                console.log('%c[WebSocket] Connected ✓', 'color: #10b981; font-weight: bold');\r\n                setIsConnected(true);\r\n                if (reconnectTimer.current) clearInterval(reconnectTimer.current);\r\n            };\r\n\r\n            socket.onmessage = (event) => {\r\n                try {\r\n                    const data = JSON.parse(event.data);\r\n                    console.log('[WebSocket] Message received:', data);\r\n                    addNotification(data);\r\n                    // Dispatch global event for data refresh\r\n                    window.dispatchEvent(new Event('app-data-refresh'));\r\n                } catch (e) {\r\n                    console.error('[WebSocket] Parse Error:', e);\r\n                }\r\n            };\r\n\r\n            socket.onclose = (e) => {\r\n                console.warn('[WebSocket] Closed:', e.reason || 'No reason');\r\n                setIsConnected(false);\r\n                // Auto-reconnect every 10 seconds if still logged in\r\n                if (!reconnectTimer.current && authService.isAuthenticated()) {\r\n                    reconnectTimer.current = setInterval(() => {\r\n                        console.log('[WebSocket] Attempting reconnect...');\r\n                        connectWebSocket(userId);\r\n                    }, 10000);\r\n                }\r\n            };\r\n\r\n            socket.onerror = (err) => {\r\n                console.error('[WebSocket] Error:', err);\r\n            };\r\n\r\n            ws.current = socket;\r\n        } catch (err) {\r\n            console.error('[WebSocket] Setup Error:', err);\r\n        }\r\n    }, [addNotification]);\r\n\r\n    useEffect(() => {\r\n        const init = async () => {\r\n            if (authService.isAuthenticated()) {\r\n                try {\r\n                    const currentUser = await authService.getCurrentUser();\r\n                    setUser(currentUser);\r\n                    fetchNotifications();\r\n                    if (currentUser?.id) {\r\n                        connectWebSocket(currentUser.id);\r\n                    }\r\n                } catch (err) {\r\n                    console.error('[Notifications] Init Error:', err);\r\n                }\r\n            }\r\n        };\r\n\r\n        if (authService.isAuthenticated() && !user) {\r\n            init();\r\n        }\r\n\r\n        return () => {\r\n            if (ws.current) ws.current.close();\r\n            if (reconnectTimer.current) clearInterval(reconnectTimer.current);\r\n        };\r\n    }, [connectWebSocket, fetchNotifications, user]);\r\n\r\n    // Fallback polling (every 2 minutes)\r\n    useEffect(() => {\r\n        const poll = setInterval(() => {\r\n            if (authService.isAuthenticated()) fetchNotifications(true);\r\n        }, 120000);\r\n        return () => clearInterval(poll);\r\n    }, [fetchNotifications]);\r\n\r\n    const markAsRead = async (id: number) => {\r\n        try {\r\n            await notificationService.markAsRead(id);\r\n            setNotifications(prev => prev.map(n => n.id === id ? { ...n, is_read: true } : n));\r\n            setUnreadCount(prev => Math.max(0, prev - 1));\r\n        } catch (err) {\r\n            console.error('[Notifications] Mark Read Error:', err);\r\n        }\r\n    };\r\n\r\n    const markAllAsRead = async () => {\r\n        try {\r\n            await notificationService.markAllAsRead();\r\n            setNotifications(prev => prev.map(n => ({ ...n, is_read: true })));\r\n            setUnreadCount(0);\r\n        } catch (err) {\r\n            console.error('[Notifications] Mark All Read Error:', err);\r\n        }\r\n    };\r\n\r\n    const getIconForToastType = (type: string) => {\r\n        switch (type) {\r\n            case 'success': return <Shield size={20} />;\r\n            case 'error': return <AlertCircle size={20} />;\r\n            case 'warning': return <Zap size={20} />;\r\n            default: return <Bell size={20} />;\r\n        }\r\n    };\r\n\r\n    return (\r\n        <NotificationContext.Provider value={{\r\n            notifications,\r\n            unreadCount,\r\n            addNotification,\r\n            markAsRead,\r\n            markAllAsRead,\r\n            refresh: fetchNotifications,\r\n            showToast,\r\n            isConnected\r\n        }}>\r\n            {children}\r\n            <AnimatePresence>\r\n                {\r\n                    toast && (\r\n                        <motion.div\r\n                            initial={{ opacity: 0, x: 100, y: 20 }}\r\n                            animate={{ opacity: 1, x: 0, y: 0 }}\r\n                            exit={{ opacity: 0, x: 100, scale: 0.9 }}\r\n                            transition={{ type: \"spring\", stiffness: 400, damping: 30 }}\r\n                            className=\"fixed top-24 right-6 z-[9999] w-full max-w-[380px]\"\r\n                        >\r\n                            <div className=\"relative group overflow-hidden rounded-2xl border border-white/20 bg-white/80 backdrop-blur-xl shadow-[0_20px_50px_rgba(0,0,0,0.1)] p-5 flex items-start gap-4 transition-all hover:shadow-[0_25px_60px_rgba(0,0,0,0.15)]\">\r\n                                <div className={`absolute top-0 left-0 w-1.5 h-full ${toast.type === 'success' ? 'bg-gradient-to-b from-emerald-400 to-teal-500' :\r\n                                    toast.type === 'error' ? 'bg-gradient-to-b from-rose-400 to-red-600' :\r\n                                        toast.type === 'warning' ? 'bg-gradient-to-b from-amber-400 to-orange-500' :\r\n                                            'bg-gradient-to-b from-indigo-500 to-blue-600'\r\n                                    }`} />\r\n\r\n                                <div className={`shrink-0 p-3 rounded-xl ${toast.type === 'success' ? 'bg-emerald-50 text-emerald-600' :\r\n                                    toast.type === 'error' ? 'bg-rose-50 text-rose-600' :\r\n                                        toast.type === 'warning' ? 'bg-amber-50 text-amber-600' :\r\n                                            'bg-indigo-50 text-indigo-600'\r\n                                    }`}>\r\n                                    {getIconForToastType(toast.type)}\r\n                                </div>\r\n\r\n                                <div className=\"flex-1 min-w-0\">\r\n                                    <div className=\"flex items-center justify-between mb-1\">\r\n                                        <span className={`text-[10px] font-bold uppercase tracking-wider ${toast.type === 'success' ? 'text-emerald-600' :\r\n                                            toast.type === 'error' ? 'text-rose-600' :\r\n                                                toast.type === 'warning' ? 'text-amber-600' :\r\n                                                    'text-indigo-600'\r\n                                            }`}>\r\n                                            {toast.type || 'info'} alert\r\n                                        </span>\r\n                                        <button\r\n                                            onClick={() => setToast(null)}\r\n                                            className=\"text-slate-400 hover:text-slate-600 transition-colors\"\r\n                                        >\r\n                                            <X size={16} />\r\n                                        </button>\r\n                                    </div>\r\n                                    <h4 className=\"text-sm font-bold text-slate-900 leading-tight mb-1\">\r\n                                        {toast.title}\r\n                                    </h4>\r\n                                    <p className=\"text-xs font-medium text-slate-600 leading-relaxed line-clamp-3\">\r\n                                        {toast.message}\r\n                                    </p>\r\n                                </div>\r\n                            </div>\r\n                        </motion.div>\r\n                    )\r\n                }\r\n            </AnimatePresence >\r\n        </NotificationContext.Provider >\r\n    );\r\n};\r\n\r\nexport const useNotifications = () => {\r\n    const context = useContext(NotificationContext);\r\n    if (context === undefined) {\r\n        throw new Error('useNotifications must be used within a NotificationProvider');\r\n    }\r\n    return context;\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}