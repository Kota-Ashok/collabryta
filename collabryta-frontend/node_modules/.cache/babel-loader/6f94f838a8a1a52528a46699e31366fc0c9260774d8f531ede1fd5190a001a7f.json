{"ast":null,"code":"var _jsxFileName = \"D:\\\\Collabryta\\\\collabryta-frontend\\\\src\\\\context\\\\NotificationContext.tsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useContext, useState, useEffect, useCallback } from 'react';\nimport { notificationService } from '../services/notificationService';\nimport { authService } from '../services/authService';\n\n/**\r\n * Context interface for managing global application notifications.\r\n */\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst NotificationContext = /*#__PURE__*/createContext(undefined);\nexport const NotificationProvider = ({\n  children\n}) => {\n  _s();\n  const [notifications, setNotifications] = useState([]);\n  const [unreadCount, setUnreadCount] = useState(0);\n  const fetchNotifications = useCallback(async () => {\n    if (!authService.isAuthenticated()) return;\n    try {\n      const data = await notificationService.getNotifications(0, 50);\n      setNotifications(data);\n      setUnreadCount(data.filter(n => !n.is_read).length);\n    } catch (err) {\n      console.error('Error fetching notifications:', err);\n    }\n  }, []);\n  const addNotification = useCallback(notification => {\n    setNotifications(prev => [notification, ...prev]);\n    setUnreadCount(prev => prev + 1);\n  }, []);\n  const markAsRead = async id => {\n    try {\n      await notificationService.markAsRead(id);\n      setNotifications(prev => prev.map(n => n.id === id ? {\n        ...n,\n        is_read: true\n      } : n));\n      setUnreadCount(prev => Math.max(0, prev - 1));\n    } catch (err) {\n      console.error('Error marking notification as read:', err);\n    }\n  };\n  const markAllAsRead = async () => {\n    try {\n      await notificationService.markAllAsRead();\n      setNotifications(prev => prev.map(n => ({\n        ...n,\n        is_read: true\n      })));\n      setUnreadCount(0);\n    } catch (err) {\n      console.error('Error marking all notifications as read:', err);\n    }\n  };\n  useEffect(() => {\n    fetchNotifications();\n  }, [fetchNotifications]);\n  return /*#__PURE__*/_jsxDEV(NotificationContext.Provider, {\n    value: {\n      notifications,\n      unreadCount,\n      addNotification,\n      markAsRead,\n      markAllAsRead,\n      refresh: fetchNotifications\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 65,\n    columnNumber: 9\n  }, this);\n};\n_s(NotificationProvider, \"3H315uDc8huypzFkwBWK5oGJBAc=\");\n_c = NotificationProvider;\nexport const useNotifications = () => {\n  _s2();\n  const context = useContext(NotificationContext);\n  if (context === undefined) {\n    throw new Error('useNotifications must be used within a NotificationProvider');\n  }\n  return context;\n};\n_s2(useNotifications, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nvar _c;\n$RefreshReg$(_c, \"NotificationProvider\");","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","useCallback","notificationService","authService","jsxDEV","_jsxDEV","NotificationContext","undefined","NotificationProvider","children","_s","notifications","setNotifications","unreadCount","setUnreadCount","fetchNotifications","isAuthenticated","data","getNotifications","filter","n","is_read","length","err","console","error","addNotification","notification","prev","markAsRead","id","map","Math","max","markAllAsRead","Provider","value","refresh","fileName","_jsxFileName","lineNumber","columnNumber","_c","useNotifications","_s2","context","Error","$RefreshReg$"],"sources":["D:/Collabryta/collabryta-frontend/src/context/NotificationContext.tsx"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect, useCallback } from 'react';\r\nimport { notificationService, Notification } from '../services/notificationService';\r\nimport { authService } from '../services/authService';\r\n\r\n/**\r\n * Context interface for managing global application notifications.\r\n */\r\ninterface NotificationContextType {\r\n    notifications: Notification[];\r\n    unreadCount: number;\r\n    addNotification: (notification: Notification) => void;\r\n    markAsRead: (id: number) => Promise<void>;\r\n    markAllAsRead: () => Promise<void>;\r\n    refresh: () => Promise<void>;\r\n}\r\n\r\nconst NotificationContext = createContext<NotificationContextType | undefined>(undefined);\r\n\r\nexport const NotificationProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {\r\n    const [notifications, setNotifications] = useState<Notification[]>([]);\r\n    const [unreadCount, setUnreadCount] = useState(0);\r\n\r\n    const fetchNotifications = useCallback(async () => {\r\n        if (!authService.isAuthenticated()) return;\r\n\r\n        try {\r\n            const data = await notificationService.getNotifications(0, 50);\r\n            setNotifications(data);\r\n            setUnreadCount(data.filter(n => !n.is_read).length);\r\n        } catch (err) {\r\n            console.error('Error fetching notifications:', err);\r\n        }\r\n    }, []);\r\n\r\n    const addNotification = useCallback((notification: Notification) => {\r\n        setNotifications(prev => [notification, ...prev]);\r\n        setUnreadCount(prev => prev + 1);\r\n    }, []);\r\n\r\n    const markAsRead = async (id: number) => {\r\n        try {\r\n            await notificationService.markAsRead(id);\r\n            setNotifications(prev => prev.map(n => n.id === id ? { ...n, is_read: true } : n));\r\n            setUnreadCount(prev => Math.max(0, prev - 1));\r\n        } catch (err) {\r\n            console.error('Error marking notification as read:', err);\r\n        }\r\n    };\r\n\r\n    const markAllAsRead = async () => {\r\n        try {\r\n            await notificationService.markAllAsRead();\r\n            setNotifications(prev => prev.map(n => ({ ...n, is_read: true })));\r\n            setUnreadCount(0);\r\n        } catch (err) {\r\n            console.error('Error marking all notifications as read:', err);\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        fetchNotifications();\r\n    }, [fetchNotifications]);\r\n\r\n    return (\r\n        <NotificationContext.Provider value={{\r\n            notifications,\r\n            unreadCount,\r\n            addNotification,\r\n            markAsRead,\r\n            markAllAsRead,\r\n            refresh: fetchNotifications\r\n        }}>\r\n            {children}\r\n        </NotificationContext.Provider>\r\n    );\r\n};\r\n\r\nexport const useNotifications = () => {\r\n    const context = useContext(NotificationContext);\r\n    if (context === undefined) {\r\n        throw new Error('useNotifications must be used within a NotificationProvider');\r\n    }\r\n    return context;\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}